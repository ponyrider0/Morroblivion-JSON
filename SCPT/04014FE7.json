{
    "Record Header": {
        "Signature": "SCPT", 
        "Data Size": 13795, 
        "Record Flags": {}, 
        "FormID": "04014FE7", 
        "Version Control Info": "00 00 00 00"
    }, 
    "EDID - Editor ID": "mwCWUTargetItemScript", 
    "SCHR - Basic Script Data": {
        "Unused": "00 00 00 00", 
        "RefCount": 21, 
        "CompiledSize": 3702, 
        "VariableCount": 37, 
        "Type": "Object:0"
    }, 
    "SCDA - Compiled Script": "1D 00 00 00 10 00 0B 00 06 00 78 00 00 00 01 00 72 01 00 16 00 0F 00 03 00 0B 00 20 66 06 00 20 5A 01 00 20 3D 3D 16 00 0D 00 01 00 09 00 20 66 22 00 20 30 20 21 3D 1C 00 01 00 6B 16 05 00 01 00 72 0A 00 19 00 00 00 19 00 00 00 65 17 22 00 01 21 00 56 01 00 00 0C 00 58 00 00 65 18 13 00 02 08 00 56 04 00 00 05 00 08 00 56 03 0B 00 0B 00 00 76 17 11 00 02 08 00 56 03 0B 00 0B 00 08 00 56 01 00 00 0C 00 11 00 00 00 10 00 08 00 05 00 44 00 00 00 00 00 16 00 22 00 02 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 11 00 00 00 10 00 08 00 04 00 F8 01 00 00 00 00 15 00 0B 00 66 03 00 06 00 20 58 50 14 00 00 65 17 22 00 01 21 00 56 01 00 00 0D 00 58 00 00 65 18 13 00 02 08 00 56 04 00 00 03 00 08 00 56 03 0D 00 03 00 00 16 00 13 00 02 00 0F 00 20 73 0D 00 20 39 39 39 39 39 20 7E 20 3D 3D 06 14 76 00 03 00 6C 00 6D 6F 72 72 6F 62 6C 69 76 69 6F 6E 2D 66 69 78 65 73 20 45 52 52 4F 52 3A 20 6D 77 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 28 6C 69 6E 65 20 36 38 29 3A 20 25 6E 28 25 69 29 20 77 61 73 20 6E 6F 74 20 66 6F 75 6E 64 20 69 6E 20 74 68 65 20 69 6E 74 65 72 6E 61 6C 20 73 65 61 72 63 68 20 6C 69 73 74 2E 66 03 00 66 03 00 1E 00 00 00 17 00 02 00 06 00 65 17 17 00 01 16 00 56 04 00 00 04 00 56 03 0D 00 05 00 56 01 00 00 0D 00 18 00 16 00 0F 00 01 00 0B 00 20 58 52 14 05 00 01 00 72 03 00 8A 14 05 00 01 00 72 0E 00 17 00 02 00 01 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 19 00 00 00 15 00 0B 00 66 06 00 06 00 20 58 CF 10 00 00 1C 00 02 00 42 11 05 00 01 00 72 04 00 16 00 0D 00 01 00 09 00 20 66 07 00 20 30 20 3D 3D 65 17 20 00 01 1F 00 56 04 00 00 07 00 58 00 00 83 18 11 00 01 05 00 52 0F 00 01 08 00 56 04 00 00 04 00 00 19 00 00 00 16 00 0F 00 01 00 0B 00 20 66 06 00 20 5A 01 00 20 21 3D 1C 00 02 00 1C 10 05 00 01 00 72 06 00 19 00 00 00 06 14 59 00 05 00 49 00 6D 6F 72 72 6F 62 6C 69 76 69 6F 6E 2D 66 69 78 65 73 3A 20 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 28 38 37 29 3A 20 25 6E 28 25 69 29 20 68 61 73 20 65 71 75 69 70 70 65 64 20 25 6E 28 25 69 29 2E 66 06 00 66 06 00 66 03 00 66 03 00 11 00 00 00 10 00 0B 00 04 00 BA 03 00 00 01 00 72 01 00 16 00 0D 00 02 00 09 00 20 66 04 00 20 30 20 3D 3D 06 14 54 00 02 00 4D 00 4D 6F 72 72 6F 62 6C 69 76 69 6F 6E 2D 66 69 78 65 73 20 45 52 52 4F 52 3A 20 6D 77 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 28 6C 69 6E 65 20 39 30 29 3A 20 6D 79 45 6E 63 68 20 3D 3D 20 30 20 28 20 25 69 20 29 66 04 00 1E 00 00 00 19 00 00 00 15 00 10 00 73 09 00 0B 00 20 58 C4 14 05 00 01 00 72 04 00 15 00 10 00 73 0B 00 0B 00 20 58 C5 14 05 00 01 00 72 04 00 16 00 0D 00 01 00 09 00 20 66 05 00 20 30 20 3D 3D 65 17 28 00 01 27 00 56 04 00 00 05 00 58 00 00 83 18 19 00 01 05 00 52 10 00 02 08 00 56 04 00 00 03 00 08 00 56 01 00 00 09 00 00 19 00 00 00 16 00 0D 00 01 00 09 00 20 66 05 00 20 30 20 21 3D 65 17 20 00 01 1F 00 56 01 00 00 0A 00 58 00 00 83 18 11 00 01 05 00 52 11 00 01 08 00 56 04 00 00 05 00 00 19 00 00 00 16 00 0C 00 02 00 08 00 20 73 0B 00 20 30 20 3E 15 00 0F 00 73 02 00 0A 00 20 73 09 00 20 73 0B 00 20 2F 15 00 0F 00 73 01 00 0A 00 20 73 0A 00 20 73 0B 00 20 2F 19 00 00 00 65 17 22 00 01 21 00 56 01 00 00 0C 00 58 00 00 65 18 13 00 02 08 00 56 04 00 00 05 00 08 00 56 03 0B 00 0B 00 00 16 00 13 00 01 00 0F 00 20 73 0C 00 20 39 39 39 39 39 20 7E 20 3D 3D 49 19 11 00 02 08 00 56 03 0B 00 0B 00 08 00 56 04 00 00 05 00 19 00 00 00 16 00 10 00 15 00 0C 00 20 72 12 00 73 0B 00 20 30 20 3D 3D 76 19 16 00 02 10 00 53 0B 00 4F 6E 53 70 65 6C 6C 43 61 73 74 05 00 52 13 00 B3 10 05 00 01 00 72 06 00 16 00 14 00 01 00 10 00 20 58 CC 16 0A 00 02 00 6E 00 00 00 00 72 03 00 15 00 18 00 72 14 00 73 21 00 10 00 20 58 20 17 0A 00 02 00 6E 00 00 00 00 72 03 00 18 00 0F 00 01 00 0B 00 20 58 CA 16 05 00 01 00 72 03 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 03 00 17 00 02 00 01 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 04 00 19 00 00 00 3E 17 50 00 03 00 3D 00 68 75 64 6D 61 69 6E 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 68 75 64 6D 61 69 6E 5F 4D 61 67 69 63 5F 49 63 6F 6E 5C 66 69 6C 65 6E 61 6D 65 7C 4D 65 6E 75 73 5C 49 63 6F 6E 73 5C 25 7A 72 14 00 73 21 00 7A 00 00 00 00 00 60 8F 40 FE 16 09 00 01 08 00 56 02 14 00 21 00 15 00 10 00 72 14 00 66 02 00 08 00 20 58 89 14 02 00 00 00 15 00 0C 00 72 14 00 66 19 00 04 00 20 66 07 00 15 00 0E 00 72 14 00 66 03 00 06 00 20 58 50 14 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 15 00 0C 00 72 14 00 73 08 00 04 00 20 73 02 00 15 00 0C 00 72 14 00 66 14 00 04 00 20 66 05 00 15 00 0C 00 72 14 00 73 1E 00 04 00 20 73 09 00 15 00 0C 00 72 14 00 73 20 00 04 00 20 73 0A 00 15 00 0C 00 72 14 00 73 1F 00 04 00 20 73 0B 00 15 00 0A 00 72 14 00 73 1B 00 02 00 20 31 19 00 00 00 16 00 0D 00 03 00 09 00 20 66 22 00 20 30 20 3D 3D 15 00 09 00 66 1F 00 04 00 20 5A 15 00 15 00 10 00 66 22 00 0B 00 20 58 B5 14 05 00 01 00 72 07 00 D1 16 0D 00 03 00 03 00 2B 25 6E 66 03 00 66 22 00 19 00 00 00 1C 00 01 00 6A 16 05 00 01 00 72 0A 00 11 00 00 00 10 00 08 00 01 00 9F 04 00 00 00 00 16 00 0D 00 01 00 09 00 20 66 03 00 20 30 20 3D 3D 15 00 0B 00 66 03 00 06 00 20 58 50 14 00 00 19 00 00 00 16 00 0D 00 1F 00 09 00 20 66 07 00 20 30 20 21 3D 15 00 0B 00 66 1D 00 06 00 20 58 07 14 00 00 16 00 0F 00 1C 00 0B 00 20 66 1D 00 20 66 22 00 20 3D 3D 16 00 17 00 05 00 13 00 20 72 01 00 58 B6 10 05 00 01 00 72 03 00 20 30 20 3D 3D 16 00 22 00 02 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 1C 00 01 00 68 16 05 00 01 00 72 03 00 19 00 00 00 76 19 16 00 02 10 00 53 0B 00 4F 6E 53 70 65 6C 6C 43 61 73 74 05 00 52 13 00 B3 10 05 00 01 00 72 06 00 16 00 14 00 01 00 10 00 20 58 CC 16 0A 00 02 00 6E 00 00 00 00 72 03 00 15 00 18 00 72 14 00 73 21 00 10 00 20 58 20 17 0A 00 02 00 6E 00 00 00 00 72 03 00 18 00 0F 00 01 00 0B 00 20 58 CA 16 05 00 01 00 72 03 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 03 00 17 00 02 00 01 00 15 00 13 00 72 14 00 73 21 00 0B 00 20 58 1E 17 05 00 01 00 72 04 00 19 00 00 00 3E 17 50 00 03 00 3D 00 68 75 64 6D 61 69 6E 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 68 75 64 6D 61 69 6E 5F 4D 61 67 69 63 5F 49 63 6F 6E 5C 66 69 6C 65 6E 61 6D 65 7C 4D 65 6E 75 73 5C 49 63 6F 6E 73 5C 25 7A 72 14 00 73 21 00 7A 00 00 00 00 00 60 8F 40 FE 16 09 00 01 08 00 56 02 14 00 21 00 15 00 10 00 72 14 00 66 02 00 08 00 20 58 89 14 02 00 00 00 15 00 0C 00 72 14 00 66 19 00 04 00 20 66 07 00 15 00 0E 00 72 14 00 66 03 00 06 00 20 58 50 14 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 15 00 0C 00 72 14 00 73 08 00 04 00 20 73 02 00 15 00 0C 00 72 14 00 66 14 00 04 00 20 66 05 00 15 00 0C 00 72 14 00 73 1E 00 04 00 20 73 09 00 15 00 0C 00 72 14 00 73 20 00 04 00 20 73 0A 00 15 00 0C 00 72 14 00 73 1F 00 04 00 20 73 0B 00 15 00 0A 00 72 14 00 73 1B 00 02 00 20 31 19 00 00 00 19 00 00 00 16 00 21 00 0F 00 1D 00 20 58 24 10 07 00 01 00 6E EA 03 00 00 20 58 24 10 07 00 01 00 6E F0 03 00 00 20 7C 7C 15 00 0D 00 66 1B 00 08 00 20 58 D9 16 02 00 00 00 16 00 0F 00 0C 00 0B 00 20 66 1B 00 20 66 03 00 20 3D 3D 16 00 0D 00 01 00 09 00 20 66 04 00 20 30 20 3D 3D 15 00 0D 00 66 04 00 08 00 20 58 89 14 02 00 00 00 19 00 00 00 15 00 15 00 73 08 00 10 00 20 58 BD 14 0A 00 02 00 72 04 00 6E 00 00 00 00 16 00 0D 00 01 00 09 00 20 66 05 00 20 30 20 21 3D 65 17 20 00 01 1F 00 56 01 00 00 0A 00 58 00 00 83 18 11 00 01 05 00 52 11 00 01 08 00 56 04 00 00 05 00 00 19 00 00 00 16 00 0C 00 01 00 08 00 20 73 0B 00 20 30 20 3E 15 00 0F 00 73 01 00 0A 00 20 73 0A 00 20 73 0B 00 20 2F 19 00 00 00 3E 17 A5 00 08 00 86 00 6D 61 67 69 63 70 6F 70 5F 66 61 6B 65 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5F 62 6F 74 74 6F 6D 5C 73 74 72 69 6E 67 7C 43 68 61 72 67 65 3A 20 25 2E 30 66 2F 25 2E 30 66 20 55 73 65 73 3A 20 25 2E 30 66 2F 25 2E 30 66 25 7B 0A 44 75 72 61 74 69 6F 6E 3A 20 25 2E 30 66 20 73 2E 25 7D 73 0A 00 73 09 00 73 01 00 73 02 00 73 08 00 73 08 00 7A 00 00 00 00 00 00 90 40 3E 17 8C 00 08 00 6D 00 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5C 6D 61 67 69 63 70 6F 70 5F 62 61 63 6B 67 72 6F 75 6E 64 5F 62 6F 74 74 6F 6D 5C 73 74 72 69 6E 67 7C 43 68 61 72 67 65 3A 20 25 2E 30 66 2F 25 2E 30 66 20 55 73 65 73 3A 20 25 2E 30 66 2F 25 2E 30 66 25 7B 0A 44 75 72 61 74 69 6F 6E 3A 20 25 2E 30 66 20 73 2E 25 7D 73 0A 00 73 09 00 73 01 00 73 02 00 73 08 00 73 08 00 7A 00 00 00 00 00 00 90 40 19 00 00 00 19 00 00 00 11 00 00 00 10 00 06 00 00 00 19 03 00 00 16 00 25 00 01 00 21 00 20 66 03 00 20 30 20 3D 3D 20 66 04 00 20 30 20 3D 3D 20 7C 7C 20 66 06 00 20 30 20 3D 3D 20 7C 7C 1E 00 00 00 19 00 00 00 16 00 0F 00 20 00 0B 00 20 66 06 00 20 5A 01 00 20 3D 3D 16 00 17 00 05 00 13 00 20 72 01 00 58 B6 10 05 00 01 00 72 03 00 20 30 20 3D 3D 16 00 22 00 03 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 06 14 5F 00 03 00 55 00 43 57 55 54 61 72 67 65 74 49 74 65 6D 53 63 72 69 70 74 20 64 65 62 75 67 20 28 6C 69 6E 65 20 32 32 33 29 3A 20 25 6E 28 25 69 29 20 6E 6F 20 6C 6F 6E 67 65 72 20 65 71 75 69 70 70 65 64 2C 20 72 65 6D 6F 76 69 6E 67 20 65 6E 63 68 61 6E 74 6D 65 6E 74 66 03 00 66 03 00 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 19 00 00 00 16 00 0D 00 17 00 09 00 20 66 07 00 20 30 20 21 3D 15 00 0B 00 66 1D 00 06 00 20 58 07 14 00 00 16 00 0F 00 14 00 0B 00 20 66 1D 00 20 66 22 00 20 3D 3D 16 00 17 00 05 00 13 00 20 72 01 00 58 B6 10 05 00 01 00 72 03 00 20 30 20 3D 3D 16 00 22 00 02 00 1E 00 20 66 04 00 20 5A 0C 00 20 21 3D 20 58 52 14 05 00 01 00 72 03 00 20 30 20 3D 3D 20 26 26 15 00 09 00 66 04 00 04 00 20 5A 0C 00 8A 14 05 00 01 00 72 04 00 19 00 00 00 1C 00 01 00 68 16 05 00 01 00 72 03 00 19 00 00 00 76 19 16 00 02 10 00 53 0B 00 4F 6E 53 70 65 6C 6C 43 61 73 74 05 00 52 13 00 B3 10 05 00 01 00 72 06 00 15 00 10 00 72 14 00 66 02 00 08 00 20 58 89 14 02 00 00 00 15 00 0C 00 72 14 00 66 19 00 04 00 20 66 07 00 15 00 0E 00 72 14 00 66 03 00 06 00 20 58 50 14 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 15 00 0C 00 72 14 00 73 08 00 04 00 20 73 02 00 15 00 0C 00 72 14 00 66 14 00 04 00 20 66 05 00 15 00 0C 00 72 14 00 73 1E 00 04 00 20 73 09 00 15 00 0C 00 72 14 00 73 20 00 04 00 20 73 0A 00 15 00 0C 00 72 14 00 73 1F 00 04 00 20 73 0B 00 15 00 0A 00 72 14 00 73 1B 00 02 00 20 31 1E 00 00 00 19 00 00 00 19 00 00 00 19 00 00 00 16 00 12 00 01 00 0E 00 20 72 02 00 58 DF 10 05 00 01 00 72 04 00 1C 00 02 00 42 11 05 00 01 00 72 04 00 19 00 00 00 16 00 23 00 05 00 1F 00 20 66 03 00 20 72 14 00 66 03 00 20 3D 3D 20 66 07 00 20 72 14 00 66 19 00 20 3D 3D 20 26 26 15 00 0C 00 73 0A 00 07 00 20 72 14 00 73 20 00 16 00 0C 00 01 00 08 00 20 73 0B 00 20 30 20 3E 15 00 0F 00 73 01 00 0A 00 20 73 0A 00 20 73 0B 00 20 2F 19 00 00 00 15 00 0C 00 72 14 00 73 04 00 04 00 20 73 01 00 19 00 00 00 11 00 00 00", 
    "SCTX - Script Source": "; Universal Cast When Used OnTarget - Item Script\n;	** Please see mwCWUItemScript for description of how CWU works. **\n;	This script is attached to clothing or armor piece that has a Targeted\n;	Cast-When-Used enchantment. In order to prevent a targeted CWU enchantment\n;	from errantly casting a potentially hostile spell whenever the item is\n;	equipped, the item's unequipped state contains a placeholder enchantment\n;	containing no magic effect.  This is dynamically replaced with the real\n;	targeted CWU enchantment when the item is equipped.  When the item is\n;	unequipped, the placeholder enchantment is put back on the item.\n;\n;	This script relies on the CWUTargetQuestScript to provide a	paired list \n;	of targetted CWU items BaseIDs and their true enchantments.\n;\nscn mwCWUTargetItemScript\n\nshort uses\nshort baseuses\n\nref me\nref myEnch\nref myWeap\nref myActor\nref mySpell\nlong dur\n\nshort ChargeMax\nshort ChargeCurrent\nshort ChargeCost\n\nshort index\nlong item_search\n\nref tempRef\nref menuSelection\n\nref currentActiveSpell\nref proxySpell\n\nbegin OnDrop Player\n	if (myActor == Player)\n		if (proxySpell != 0)\n			player.RemoveSpellNS proxySpell\n		endif\n	endif\n\n	Let index := ar_Find myWeap mwCWUInit.Inventory\n	ar_Erase mwCWUInit.Inventory index\nend\n\nbegin OnUnEquip\n\n	; reset item's enchantment to placeholder (workaround for instant-cast on equip bug)\n	if (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n		set myEnch to mwCWUTargetEn\n		SetEnchantment myEnch\n	endif\n\nend\n\nbegin OnEquip\n\n	set me to GetBaseObject\n\n	let item_search := ar_Find me mwCWUTargetQuest.itemList\n	if (item_search == -99999)\n		PrintC \"morroblivion-fixes ERROR: mwCWUTargetItemScript (line 68): %n(%i) was not found in the internal search list.\", me, me\n		return\n	else\n		let myEnch := mwCWUTargetQuest.itemEnchantmentMap[item_search]\n		if (IsWeapon me)\n			; if weapon, then keep placeholder enchantment -- otherwise will break engine\n			SetEnchantment mwCWUDummyWeaponEnch\n		else\n			; only replace placeholder enchantment if item is a non-weapon\n			SetEnchantment myEnch\n		endif\n	endif\n\n	set myActor to GetContainer\n	myActor.Dispel myEnch\n	if mySpell == 0\n		Let mySpell := Call mwCWUSpellCreationFunc myEnch\n	endif\n	if myActor != Player\n		myActor.AddSpell mySpell\n	endif\n	PrintC \"morroblivion-fixes: CWUTargetItemScript (87): %n(%i) has equipped %n(%i).\", myActor, myActor, me, me\n\nend\n\nbegin OnEquip Player\n\n	if (myEnch == 0)\n		printc \"Morroblivion-fixes ERROR: mwCWUTargetItemScript (line 90): myEnch == 0 ( %i )\", myEnch\n		return\n	endif\n\n	set ChargeMax to GetEnchantmentCharge myEnch\n	set ChargeCost to GetEnchantmentCost myEnch\n	\n	if myWeap == 0\n		Let myWeap := Call mwCWUSetupWeaponTokenFunc me ChargeMax\n	endif\n\n	if myWeap != 0\n		Let ChargeCurrent := Call mwCWUGetCurrentChargeFunc myWeap\n	endif\n\n	if ChargeCost > 0\n		set baseuses to ChargeMax / ChargeCost\n		set uses to ChargeCurrent / ChargeCost\n	endif\n\n	Let index := ar_Find myWeap mwCWUInit.Inventory\n	if index == -99999\n		ar_Append mwCWUInit.Inventory myWeap\n	endif\n\n; This is the original code which selected the enchantment spell as soon as the item was equipped.\n; The new method is to require selection of the enchantment through the magic menu.  This avoids\n; the need to un-equip/re-equip items to reselect an enchantment.\n; ------------------ Select Enchantment On Equip -------------------------\n	if (mwFixes.StrictMWEnchantmentSelection == 0)\n		RemoveEventHandler \"OnSpellCast\" mwCWUCastEventHandler\n		SelectPlayerSpell mySpell\n		if (IsBipedIconPathValid 0 me)\n			set mwCWU.IconString to GetBipedIconPath 0 me\n		elseif (IsIconPathValid me)\n			set mwCWU.IconString to GetIconPath me\n		else\n			set mwCWU.IconString to GetIconPath myEnch\n		endif\n		SetMenuStringValue \"hudmain_background\\hudmain_Magic_Icon\\filename|Menus\\Icons\\%z\" mwCWU.IconString 1004\n		sv_Destruct mwCWU.IconString\n		;===Setting Variables needed for Quest part\n		set mwCWU.Ench to GetEnchantment\n;		set mwCWU.Ench to myEnch\n		set mwCWU.ItemSpell to mySpell\n		set mwCWU.Item to GetBaseObject\n		set mwCWU.Itemuses to uses\n		set mwCWU.Itemusesmax to baseuses\n		set mwCWU.ItemWeap to myWeap\n		set mwCWU.ItemChargeMax to ChargeMax\n		set mwCWU.ItemChargeCurrent to ChargeCurrent\n		set mwCWU.ItemChargeCost to ChargeCost\n		set mwCWU.onplayer to 1\n	endif\n\n	if (proxySpell == 0)\n		set tempRef to mwCWUProxySpell\n		set proxySpell to CloneForm tempRef\n		SetNameEx \"+%n\", me, proxySpell\n	endif\n\n	player.AddSpellNS proxySpell	\n			\nend\n\nbegin MenuMode\n	if me == 0\n		set me to GetBaseObject\n	endif\n\n	; Detect proxyScroll activation\n	if (mySpell != 0)\n		set currentActiveSpell to GetPlayerSpell\n		if (currentActiveSpell == proxySpell) 			\n			; equip enchanted item if not already equipped\n			if (player.GetEquipped me == 0)			\n				; sanity check to make sure that the true enchantment is removed before equipping (workaround for cast-on-equip bug)\n				if (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n					set myEnch to mwCWUTargetEn\n					SetEnchantment myEnch\n				endif\n				Player.EquipItemNS me\n			endif\n\n			RemoveEventHandler \"OnSpellCast\" mwCWUCastEventHandler\n			SelectPlayerSpell mySpell\n			; set the active spell icon\n;			set mwCWU.IconString to GetBipedIconPath 0 me\n			if (IsBipedIconPathValid 0 me)\n				set mwCWU.IconString to GetBipedIconPath 0 me\n			elseif (IsIconPathValid me)\n				set mwCWU.IconString to GetIconPath me\n			else\n				set mwCWU.IconString to GetIconPath myEnch\n			endif\n			SetMenuStringValue \"hudmain_background\\hudmain_Magic_Icon\\filename|Menus\\Icons\\%z\" mwCWU.IconString 1004\n			sv_Destruct mwCWU.IconString\n				;===Setting Variables needed for Quest part\n			set mwCWU.Ench to GetEnchantment\n;			set mwCWU.Ench to myEnch\n			set mwCWU.ItemSpell to mySpell\n			set mwCWU.Item to GetBaseObject\n			set mwCWU.Itemuses to uses\n			set mwCWU.Itemusesmax to baseuses\n			set mwCWU.ItemWeap to myWeap\n			set mwCWU.ItemChargeMax to ChargeMax\n			set mwCWU.ItemChargeCurrent to ChargeCurrent\n			set mwCWU.ItemChargeCost to ChargeCost\n			set mwCWU.onplayer to 1\n		endif\n	endif\n	\n	if MenuMode 1002 || MenuMode 1008\n\n		set menuSelection to GetActiveMenuSelection\n\n; ------------- MouseOver Enchantment \"tooltip\" info ----------		\n		if (menuSelection == me)\n			if (myEnch == 0)\n				set myEnch to GetEnchantment\n			endif\n\n			set dur to GetNthEffectItemDuration myEnch 0\n\n			if myWeap != 0\n				Let ChargeCurrent := Call mwCWUGetCurrentChargeFunc myWeap\n			endif\n\n			if ChargeCost > 0\n				set uses to ChargeCurrent / ChargeCost\n			endif\n\n			SetMenuStringValue \"magicpop_fake_background\\magicpop_background\\magicpop_background_bottom\\string|Charge: %.0f/%.0f Uses: %.0f/%.0f%{%rDuration: %.0f s.%}\" ChargeCurrent ChargeMax uses baseuses dur dur 1024\n			SetMenuStringValue \"magicpop_background\\magicpop_background_bottom\\string|Charge: %.0f/%.0f Uses: %.0f/%.0f%{%rDuration: %.0f s.%}\" ChargeCurrent ChargeMax uses baseuses dur dur 1024\n		endif\n\n	endif\nend\n\nbegin GameMode\n\n	if (me == 0) || (myEnch == 0) || (myActor == 0)\n		return\n	endif\n\n	; Make sure enchantment is removed if item is not equipped\n	if (myActor == player) \n\n		; detect any programmatic unequipping that left real enchantment active\n		if (player.GetEquipped me == 0)\n			if (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n				PrintC \"CWUTargetItemScript debug (line 223): %n(%i) no longer equipped, removing enchantment\", me, me\n				set myEnch to mwCWUTargetEn\n				SetEnchantment myEnch\n			endif\n		endif\n\n		; Detect proxySpell activation\n		if (mySpell != 0)\n			set currentActiveSpell to GetPlayerSpell\n			if (currentActiveSpell == proxySpell) \n;				printc \"CWUTargetItemScript (line 234): ActiveSpell=[%n](%i) , mySpell=[%n](%i)\", currentActiveSpell, currentActiveSpell, mySpell, mySpell\n				; equip enchanted item if not already equipped\n				if (player.GetEquipped me == 0)			\n					; sanity check to make sure that the true enchantment is removed before equipping (workaround for cast-on-equip bug)\n					if (myEnch != mwCWUTargetEn) && (IsWeapon me == 0)\n						set myEnch to mwCWUTargetEn\n						SetEnchantment myEnch\n					endif\n					Player.EquipItemNS me\n				endif\n\n				RemoveEventHandler \"OnSpellCast\" mwCWUCastEventHandler\n				SelectPlayerSpell mySpell\n				;===Setting Variables needed for Quest part\n				set mwCWU.Ench to GetEnchantment\n;				set mwCWU.Ench to myEnch\n				set mwCWU.ItemSpell to mySpell\n				set mwCWU.Item to GetBaseObject\n				set mwCWU.Itemuses to uses\n				set mwCWU.Itemusesmax to baseuses\n				set mwCWU.ItemWeap to myWeap\n				set mwCWU.ItemChargeMax to ChargeMax\n				set mwCWU.ItemChargeCurrent to ChargeCurrent\n				set mwCWU.ItemChargeCost to ChargeCost\n				set mwCWU.onplayer to 1				\n				return\n			endif\n		endif\n			\n	endif\n\n	if myActor.IsSpellTarget myEnch\n		myActor.Dispel myEnch\n	endif\n\n	; if me == currently active enchant item, then update local data with active enchant item values\n	if me == mwCWU.Item && mySpell == mwCWU.ItemSpell\n;		printc \"CWU OnTarget: %n(%i) - enchantment active\", me, me\n		set ChargeCurrent to mwCWU.ItemChargeCurrent\n		if ChargeCost > 0\n			set uses to ChargeCurrent / ChargeCost\n		endif\n		set mwCWU.Itemuses to uses\n\n	endif\n\nend", 
    "Local Variables": [
        {
            "SLSD - Local Variable Data": {
                "Index": "00000001", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "uses"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000002", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "baseuses"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000003", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "me"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000004", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "myEnch"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000005", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "myWeap"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000006", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "myActor"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000007", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "mySpell"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000008", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "dur"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000009", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "ChargeMax"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000000A", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "ChargeCurrent"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000000B", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "ChargeCost"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000000C", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "index"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000000D", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {
                    "IsLongOrShort": true
                }, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "item_search"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000001B", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "menuSelection"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000001D", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "currentActiveSpell"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "0000001F", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "tempRef"
        }, 
        {
            "SLSD - Local Variable Data": {
                "Index": "00000022", 
                "Unused": "00 00 00 00 00 00 00 00 00 00 00 00", 
                "Flags": {}, 
                "Unused": "00 00 00 00 00 00 00"
            }, 
            "SCVR - Name": "proxySpell"
        }
    ], 
    "References": [
        "SCRO - Global Reference": "PlayerRef [PLYR:00000014]", 
        "SCRV - Local Variable": "00000006", 
        "SCRV - Local Variable": "00000003", 
        "SCRV - Local Variable": "00000004", 
        "SCRV - Local Variable": "00000005", 
        "SCRV - Local Variable": "00000007", 
        "SCRV - Local Variable": "0000001F", 
        "SCRV - Local Variable": "0000001B", 
        "SCRV - Local Variable": "0000001D", 
        "SCRV - Local Variable": "00000022", 
        "SCRO - Global Reference": " [:03004337]", 
        "SCRO - Global Reference": "mwCWUTargetEn [ENCH:06016CCF]", 
        "SCRO - Global Reference": "mwCWUTargetQuest [QUST:06014FE8]", 
        "SCRO - Global Reference": "mwCWUDummyWeaponEnch [ENCH:03004BAD]", 
        "SCRO - Global Reference": "mwCWUSpellCreationFunc [SCPT:0300E3E6]", 
        "SCRO - Global Reference": "mwCWUSetupWeaponTokenFunc [SCPT:0302E825]", 
        "SCRO - Global Reference": "mwCWUGetCurrentChargeFunc [SCPT:0302B659]", 
        "SCRO - Global Reference": "mwFixes [QUST:0604897B]", 
        "SCRO - Global Reference": "mwCWUCastEventHandler [SCPT:0300650C]", 
        "SCRO - Global Reference": " [:03001075]", 
        "SCRO - Global Reference": "mwCWUProxySpell [SPEL:06059B5E]"
    ]
}
